commit-msg:
  commands:
    conventional-commit:
      run: |
        msg=$(head -1 {1})
        if ! echo "$msg" | grep -qE '^(feat|fix|docs|refactor|test|chore|ci|perf|style|build|revert)(\(.+\))?: .+'; then
          echo "‚ùå Commit message must follow Conventional Commits format:"
          echo ""
          echo "  <type>: <description>"
          echo ""
          echo "  Types: feat, fix, docs, refactor, test, chore, ci, perf, style, build, revert"
          echo ""
          echo "  Examples:"
          echo "    feat: add tenant suspension endpoint"
          echo "    fix(api): handle duplicate slug error"
          echo "    docs: update architecture diagram"
          echo ""
          echo "  Got: $msg"
          exit 1
        fi

pre-commit:
  parallel: true
  commands:
    go-fmt:
      glob: "*.go"
      run: gofmt -l {staged_files} | xargs -r echo "Unformatted files:" && test -z "$(gofmt -l {staged_files})"
    go-vet:
      glob: "*.go"
      run: go vet ./...
    go-lint:
      glob: "*.go"
      run: go tool golangci-lint run ./...
    go-test:
      glob: "*.go"
      run: go test ./...

    # Future: React/TypeScript hooks
    # ts-lint:
    #   glob: "*.{ts,tsx}"
    #   root: "web/"
    #   run: npx eslint {staged_files}
    # ts-typecheck:
    #   glob: "*.{ts,tsx}"
    #   root: "web/"
    #   run: npx tsc --noEmit
